<%= labelled_form_for @issue_template, :html => {:id => 'issue-template-form'} do |f| %>

  <%= error_messages_for 'issue_template' %>

  <div class="box tabular">
    <div id="all_attributes">

      <%= f.hidden_field :project_id, value: @issue_template.project.id %>

      <p class="pull-right-with-marging">
        <%= f.check_box :template_enabled, :no_label => true %><label class="inline" for="issue_template_is_enabled" id="issue_template_is_enabled"><%= l(:template_is_enabled) %></label>
      </p>

      <p>
        <%= f.text_field :template_title, :size => 80, :maxlength => 255, :required => true %>
      </p>

      <p><%= f.select :project_id, project_tree_options_for_select(@issue_template.allowed_target_projects, :selected => @issue_template.project), {:required => true} %></p>

      <div class="separator"></div>

      <p class="pull-right-with-marging">
        <%= f.check_box :is_private, :no_label => true %><label class="inline" for="issue_is_private" id="issue_is_private_label"><%= l(:field_is_private) %></label>
      </p>

      <p><%= f.select :tracker_id, @issue_template.project.trackers.collect {|t| [t.name, t.id]}, {:required => true} %></p>

      <p><%= f.text_field :subject, :size => 80, :maxlength => 255, :required => true %></p>

      <p>
        <%= f.label_for_field :description, :required => false %>
        <%= content_tag 'span', :id => "issue_description_and_toolbar" do %>
          <%= f.text_area :description,
                          :cols => 60,
                          :rows => (@issue_template.description.blank? ? 10 : [[10, @issue_template.description.length / 50].max, 100].min),
                          :accesskey => accesskey(:edit),
                          :class => 'wiki-edit',
                          :no_label => true %>
        <% end %>
      </p>
      <%= wikitoolbar_for 'issue_description' %>

      <div id="attributes" class="attributes">

        <div class="splitcontent">
          <div class="splitcontentleft">

            <p><%= f.select :status_id, (IssueStatus.all.collect {|p| [p.name, p.id]}), {:required => true} %></p>

            <p><%= f.select :priority_id, (@priorities.collect {|p| [p.name, p.id]}), {:required => true}, :disabled => false %></p>

            <p><%= f.select :category_id, (@issue_template.project.issue_categories.collect {|c| [c.name, c.id]}), :include_blank => true, :required => false %>
              <%= link_to(image_tag('add.png', :style => 'vertical-align: middle;'),
                          new_project_issue_category_path(@issue_template.project),
                          :remote => true,
                          :method => 'get',
                          :title => l(:label_issue_category_new),
                          :tabindex => 200) if User.current.allowed_to?(:manage_categories, @issue_template.project) %></p>

          </div>

          <div class="splitcontentright">

            <p><%= f.text_field :start_date, :size => 10, :disabled => false, :required => false %><%= calendar_for('issue_template_start_date') %></p>

            <p><%= f.text_field :due_date, :size => 10, :disabled => false, :required => false %><%= calendar_for('issue_template_due_date') %></p>

            <p><%= f.text_field :estimated_hours, :size => 3, :disabled => false, :required => false %> <%= l(:field_hours) %></p>

            <p><%= f.select :done_ratio, ((0..10).to_a.collect {|r| ["#{r*10} %", r*10] }), :required => false %></p>

          </div>
        </div>

        <% include_calendar_headers_tags %>

      </div>

    </div>


  </div>

  <%= submit_tag l(:button_save_issue_template) %>

  <%= javascript_tag "$('#issue_template_template_title').focus();" %>

<% end %>